---
// src/pages/form.astro
// src/pages/form.astro
import BaseLayout from '../layouts/BaseLayout.astro';

// Simple form state management
interface FormData {
  name?: string;
  email?: string;
  message?: string;
  phone?: string;
  [key: string]: any;
}

let formData: FormData = {};
let successMessage = '';

// Handle form submission
if (Astro.request.method === 'POST') {
  try {
    const formDataRaw = await Astro.request.formData();
    formData = Object.fromEntries(formDataRaw);
    
    // Solo necesitamos los campos requeridos del formulario de Consulta General
    const requiredFields = ['name', 'email', 'message'];
    
    const isValid = requiredFields.every(field => formData[field]);
    
    if (isValid) {
      // Aquí puedes agregar tu integración de servicio de email más tarde
      successMessage = '¡Mensaje enviado con éxito! Nos pondremos en contacto contigo pronto.';
      formData = {}; // Resetear formulario al enviar correctamente
    } else {
        console.warn('Formulario no válido o campos incompletos.');
    }
  } catch (error) {
    console.error('Error processing form:', error);
  }
}
---

<BaseLayout 
  title="Contáctanos - Grupo Linea Digital" 
  description="Ponte en contacto con nosotros.">
  
  <main class="min-h-screen bg-[#0F172A] text-white pt-12 pb-20 md:pt-20 md:pb-24">
    <div class="container mx-auto px-4">

      {successMessage && (
        <div class="bg-green-700 bg-opacity-30 border border-green-500 text-green-200 px-4 py-3 rounded mb-8 text-center max-w-7xl mx-auto">
          {successMessage}
        </div>
      )}

      <div class="grid grid-cols-1 lg:grid-cols-2 max-w-7xl mx-auto rounded-xl overflow-hidden shadow-2xl relative">
        
        <div class="bg-[#121720] p-8 md:p-12 lg:p-16">
          <h2 class="text-xs font-semibold uppercase tracking-widest text-blue-600 mb-2">
            CONTÁCTANOS
          </h2>
          <h1 class="text-4xl md:text-5xl font-bold mb-10 leading-tight">
            Hablemos sobre tu proyecto.
          </h1>
          
          <div class="grid grid-cols-1 sm:grid-cols-2 gap-10">
            <div>
              <h3 class="text-lg font-semibold mb-2">Nuestra Ubicación</h3>
              <p class="text-gray-400">1a Avenida Norte Poniente #834, Centro, CP 29000,</p>
              <p class="text-gray-400">Tuxtla Gutiérrez, Chiapas</p>
            </div>

            <div>
              <h3 class="text-lg font-semibold mb-2">Correo Electrónico</h3>
              <p><a href="mailto:info@linea-digital.com" class="text-gray-400 hover:text-white transition-colors">info@linea-digital.com</a></p>
              <p><a href="mailto:ventas@linea-digital.com" class="text-gray-400 hover:text-white transition-colors">ventas@linea-digital.com</a></p>
            </div>
            
            <div>
              <h3 class="text-lg font-semibold mb-2">Contacto Rápido</h3>
              <p class="text-gray-400 mb-2">Llámanos o escríbenos por WhatsApp:</p>

              <p class="text-gray-400">+990 846 73644</p>
              <p class="text-gray-400">+550 9475 4543</p>
              
              <a 
                href="https://wa.me/1234567890?text=Hola,%20me%20interesa%20obtener%20información%20sobre%20sus%20servicios." 
                target="_blank" 
                rel="noopener noreferrer"
                class="inline-flex items-center mt-3 px-4 py-2 text-sm bg-green-600 hover:bg-green-700 text-white font-medium rounded-full transition-colors"
              >
                <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.966-.273-.099-.471-.148-.67.15-.197.297-.767.963-.94 1.16-.173.199-.347.222-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.795-1.484-1.77-1.66-2.07-.173-.297-.018-.458.132-.606.136-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.611-.916-2.207-.242-.579-.487-.5-.669-.508-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.718 2.005-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.548 4.142 1.588 5.945L0 24l6.305-1.654a11.882 11.882 0 005.74 1.466h.005c6.554 0 11.89-5.335 11.89-11.893 0-3.176-1.24-6.165-3.495-8.411"/>
                </svg>
                Chatea con nosotros ahora
              </a>

            </div>

            <div>
              <h3 class="text-lg font-semibold mb-2">¿Cómo podemos ayudarte?</h3>
              <p class="text-gray-400">Cuéntanos tu problema, te responderemos lo antes posible.</p>
            </div>
          </div>
          
        </div>

        <div class="bg-[#121720] p-8 md:p-12 lg:p-16 z-10">
          <h2 class="text-3xl md:text-4xl text-center font-semibold mb-8">Envíanos un Mensaje</h2>

          <div id="contact-form" class="form-section">
            <form method="POST">
              <input type="hidden" name="formType" value="contact" />
              
              <div class="mb-6">
                <label for="name" class="block text-sm font-medium mb-1 text-gray-300">Nombre Completo*</label>
                <input 
                  type="text" 
                  id="name" 
                  name="name" 
                  value={formData.name || ''}
                  required 
                  placeholder="Introduce tu nombre completo"
                  class="w-full px-4 py-3 bg-white border border-gray-600 rounded-lg text-white placeholder-[#121720] focus:ring-2 focus:ring-[#4183D7] focus:border-[#4183D7] transition-colors"
                />
              </div>

              <div class="mb-6">
                <label for="email" class="block text-sm font-medium mb-1 text-gray-300">Correo Electrónico*</label>
                <input 
                  type="email" 
                  id="email" 
                  name="email" 
                  value={formData.email || ''}
                  required 
                  placeholder="Introduce tu correo electrónico"
                  class="w-full px-4 py-3 bg-white border border-gray-600 rounded-lg text-white placeholder-[#121720] focus:ring-2 focus:ring-[#4183D7] focus:border-[#4183D7] transition-colors"
                />
              </div>

              <div class="mb-8">
                <label for="message" class="block text-sm font-medium mb-1 text-gray-300">Mensaje*</label>
                <textarea 
                  id="message" 
                  name="message" 
                  rows="4" 
                  required
                  placeholder="Escribe tu mensaje aquí"
                  class="w-full px-4 py-3 bg-white border border-gray-600 rounded-lg text-white placeholder-[#121720] focus:ring-2 focus:ring-[#4183D7] focus:border-[#4183D7] transition-colors"
                >{formData.message || ''}</textarea>
              </div>
              
              <div class="mb-8">
                <label for="phone" class="block text-sm font-medium mb-1 text-gray-300">Teléfono (Opcional)</label>
                <input 
                  type="tel" 
                  id="phone" 
                  name="phone" 
                  placeholder="Introduce tu número de teléfono"
                  class="w-full px-4 py-3 bg-white border border-gray-600 rounded-lg text-white placeholder-[#121720] focus:ring-2 focus:ring-[#4183D7] focus:border-[#4183D7] transition-colors"
                />
              </div>

              <button 
                type="submit" 
                class="w-full bg-blue-700 text-white font-semibold py-3 rounded-lg hover:bg-blue-700/50 transition-colors shadow-lg"
              >
                Enviar Mensaje
              </button>
            </form>
          </div>
          </div>

      </div>
    </div>
  </main>

  <style>
    /* Estilos simplificados, centrados en la visibilidad y accesibilidad */
    .form-section {
      position: relative;
      z-index: 20; 
    }
    
    /* Reglas para asegurar la visibilidad del texto y placeholder */
    .form-section ::placeholder {
      color: #9CA3AF !important; 
      opacity: 1; 
    }
    
    /* Quitamos el script showForm ya que no hay pestañas */
  </style>

</BaseLayout>