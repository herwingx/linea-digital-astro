---
// src/pages/faq.astro
import BaseLayout from "../layouts/BaseLayout.astro";
import FAQAccordion from "../components/FAQAccordion.astro"; // Tu componente existente o actualizado

const faqs = {
  planes: [
    {
      question: "¬øQu√© incluyen los Planes Telcel Plus?",
      answer:
        "Los Planes Telcel Plus incluyen minutos y SMS ilimitados en M√©xico, Estados Unidos y Canad√°, adem√°s de redes sociales ilimitadas (WhatsApp, Facebook, X, Instagram, Snapchat y Uber) y una cantidad de Gigas para navegar libremente.",
    },
    {
      question: "¬øPuedo conservar mi n√∫mero si me cambio a Telcel?",
      answer:
        "¬°S√≠! El tr√°mite se llama Portabilidad y es totalmente gratuito. Solo necesitas tu NIP de portabilidad (env√≠a NIP al 051) y una identificaci√≥n oficial. Nosotros nos encargamos de todo el proceso en menos de 24 horas.",
    },
    {
      question: "¬øCu√°l es la vigencia de mi plan?",
      answer:
        "Manejamos planes libres (sin plazo forzoso) y planes con equipo incluido a 12, 18, 24 o 36 meses. T√∫ eliges la opci√≥n que mejor se adapte a tus necesidades.",
    },
  ],
  internet: [
    {
      question: "¬øC√≥mo funciona el Internet en Casa?",
      answer:
        "Es muy sencillo: te entregamos un m√≥dem que solo necesitas conectar a la luz y ¬°listo! No requiere instalaci√≥n t√©cnica ni cableado. Funciona a trav√©s de la red 4G/5G de Telcel.",
    },
    {
      question: "¬øPuedo mover el m√≥dem a otra casa?",
      answer:
        "El servicio est√° dise√±ado para funcionar en una ubicaci√≥n espec√≠fica (la que registraste al contratar). Si necesitas cambiar de domicilio, debes notificarlo para actualizar la ubicaci√≥n del servicio ($100 costo por cambio de ubicaci√≥n).",
    },
  ],
  pagos: [
    {
      question: "¬øD√≥nde puedo pagar mi factura?",
      answer:
        "Puedes pagar en nuestra app Mi Telcel, en cualquiera de nuestras sucursales, bancos, OXXO, o domiciliar el cargo a tu tarjeta de cr√©dito/d√©bito para mayor comodidad.",
    },
    {
      question: "¬øQu√© pasa si me atraso en mi pago?",
      answer:
        "Si no realizas el pago antes de tu fecha l√≠mite, el servicio podr√≠a suspenderse temporalmente. Te recomendamos domiciliar tu pago para evitar interrupciones y cargos por reconexi√≥n.",
    },
  ],
};

// Schema JSON-LD
const schema = {
  "@context": "https://schema.org",
  "@type": "FAQPage",
  mainEntity: Object.values(faqs)
    .flat()
    .map((item) => ({
      "@type": "Question",
      name: item.question,
      acceptedAnswer: {
        "@type": "Answer",
        text: item.answer,
      },
    })),
};
---

<BaseLayout
  title="Centro de Ayuda | L√≠nea Digital"
  description="Respuestas r√°pidas sobre planes Telcel, Internet, Pagos y Soporte T√©cnico."
>
  <!-- 1. HERO SECTION CON BUSCADOR -->
  <section class="relative px-4 bg-slate-50 dark:bg-slate-950 overflow-hidden">
    <!-- Luces Ambientales -->
    <div
      class="absolute top-0 left-1/2 -translate-x-1/2 w-full max-w-5xl h-[500px] bg-blue-500/10 blur-[120px] rounded-full pointer-events-none"
    >
    </div>

    <div class="relative z-10 max-w-3xl mx-auto text-center">
      <div
        class="inline-flex items-center gap-2 rounded-full border border-blue-200 bg-blue-50 px-3 py-1 mb-6 dark:border-blue-900/30 dark:bg-blue-900/10 backdrop-blur-md"
      >
        <span class="relative flex h-2 w-2">
          <span
            class="animate-ping absolute inline-flex h-full w-full rounded-full bg-blue-400 opacity-75"
          ></span>
          <span class="relative inline-flex rounded-full h-2 w-2 bg-blue-500"
          ></span>
        </span>
        <span
          class="text-xs font-bold uppercase tracking-widest text-blue-600 dark:text-blue-400"
          >Soporte 24/7</span
        >
      </div>

      <h1
        class="text-4xl md:text-6xl font-bold tracking-tight text-slate-900 dark:text-white mb-6"
      >
        Centro de Ayuda
      </h1>
      <p class="text-lg text-slate-600 dark:text-slate-400 mb-10">
        Todo lo que necesitas saber para aprovechar al m√°ximo tus servicios
        Telcel.
      </p>

      <!-- BUSCADOR ESTILIZADO -->
      <div class="relative group max-w-xl mx-auto">
        <div
          class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none text-slate-400 group-focus-within:text-blue-500 transition-colors"
        >
          <svg
            class="h-5 w-5"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
            ><path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg
          >
        </div>
        <input
          type="text"
          id="faq-search"
          placeholder="Busca 'portabilidad', 'pagos', 'internet'..."
          class="w-full pl-11 pr-4 py-4 rounded-2xl bg-white/80 dark:bg-slate-800/80 border border-slate-200 dark:border-slate-700 shadow-xl shadow-slate-200/20 dark:shadow-none focus:ring-4 focus:ring-blue-500/10 focus:border-blue-500 outline-none transition-all backdrop-blur-xl"
        />
      </div>
    </div>
  </section>

  <!-- 2. CONTENIDO SPLIT (Sticky Sidebar en Desktop) -->
  <section class="pb-24 bg-slate-50 dark:bg-slate-950 min-h-[60vh]">
    <div class="container mx-auto px-4 max-w-6xl">
      <div class="grid grid-cols-1 lg:grid-cols-12 gap-12">
        <!-- SIDEBAR DE NAVEGACI√ìN -->
        <div class="hidden lg:block lg:col-span-3">
          <nav class="sticky top-32 space-y-2">
            <p
              class="text-xs font-bold uppercase tracking-widest text-slate-400 mb-4 pl-4"
            >
              Categor√≠as
            </p>

            <a
              href="#planes"
              class="block w-full text-left px-4 py-3 rounded-xl text-sm font-bold text-slate-600 hover:text-blue-600 hover:bg-white transition-all dark:text-slate-400 dark:hover:bg-white/5 dark:hover:text-white"
            >
              üì± Planes M√≥viles
            </a>
            <a
              href="#internet"
              class="block w-full text-left px-4 py-3 rounded-xl text-sm font-bold text-slate-600 hover:text-blue-600 hover:bg-white transition-all dark:text-slate-400 dark:hover:bg-white/5 dark:hover:text-white"
            >
              üè† Internet en Casa
            </a>
            <a
              href="#pagos"
              class="block w-full text-left px-4 py-3 rounded-xl text-sm font-bold text-slate-600 hover:text-blue-600 hover:bg-white transition-all dark:text-slate-400 dark:hover:bg-white/5 dark:hover:text-white"
            >
              üí≥ Pagos y Facturaci√≥n
            </a>
          </nav>
        </div>

        <!-- √ÅREA DE PREGUNTAS -->
        <div class="lg:col-span-9 space-y-16">
          <!-- Planes M√≥viles -->
          <div id="planes" class="faq-section scroll-mt-28">
            <div class="flex items-center gap-4 mb-6">
              <div
                class="p-3 bg-blue-50 dark:bg-blue-900/40 text-blue-600 rounded-2xl shrink-0"
              >
                <svg
                  class="w-6 h-6"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                  ><path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"
                  ></path></svg
                >
              </div>
              <h2 class="text-2xl font-bold text-slate-900 dark:text-white">
                Planes M√≥viles
              </h2>
            </div>
            <div class="space-y-4">
              <FAQAccordion items={faqs.planes} />
            </div>
          </div>

          <!-- Internet -->
          <div id="internet" class="faq-section scroll-mt-28">
            <div class="flex items-center gap-4 mb-6">
              <div
                class="p-3 bg-indigo-100 dark:bg-indigo-900/40 text-indigo-600 rounded-2xl shrink-0"
              >
                <svg
                  class="w-6 h-6"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                  ><path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.141 0M1.394 9.393c5.857-5.857 15.355-5.857 21.213 0"
                  ></path></svg
                >
              </div>
              <h2 class="text-2xl font-bold text-slate-900 dark:text-white">
                Internet en Casa
              </h2>
            </div>
            <div class="space-y-4">
              <FAQAccordion items={faqs.internet} />
            </div>
          </div>

          <!-- Pagos -->
          <div id="pagos" class="faq-section scroll-mt-28">
            <div class="flex items-center gap-4 mb-6">
              <div
                class="p-3 bg-emerald-100 dark:bg-emerald-900/40 text-emerald-600 rounded-2xl shrink-0"
              >
                <svg
                  class="w-6 h-6"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                  ><path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"
                  ></path></svg
                >
              </div>
              <h2 class="text-2xl font-bold text-slate-900 dark:text-white">
                Pagos y Facturaci√≥n
              </h2>
            </div>
            <div class="space-y-4">
              <FAQAccordion items={faqs.pagos} />
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- CTA HELP DESK -->
  <section
    class="py-20 px-6 bg-white dark:bg-slate-900 border-t border-slate-100 dark:border-white/5"
  >
    <div
      class="mx-auto max-w-4xl bg-gradient-to-br from-blue-600 to-blue-600 rounded-[2.5rem] p-10 md:p-16 text-center shadow-2xl shadow-blue-900/20 overflow-hidden relative"
    >
      <!-- Decorative Circles -->
      <div
        class="absolute top-0 right-0 w-64 h-64 bg-white/10 rounded-full blur-3xl -mr-20 -mt-20 pointer-events-none"
      >
      </div>
      <div
        class="absolute bottom-0 left-0 w-64 h-64 bg-black/10 rounded-full blur-3xl -ml-20 -mb-20 pointer-events-none"
      >
      </div>

      <div class="relative z-10">
        <h3 class="text-3xl md:text-4xl font-bold text-white mb-4">
          ¬øNo encontraste tu respuesta?
        </h3>
        <p class="text-blue-50 mb-8 text-lg max-w-xl mx-auto">
          Nuestro equipo de soporte est√° disponible para resolver cualquier
          situaci√≥n espec√≠fica.
        </p>

        <div class="flex flex-col sm:flex-row justify-center gap-4">
          <a
            href="https://wa.me/529616189200"
            target="_blank"
            class="inline-flex items-center justify-center gap-2 px-8 py-3.5 bg-white text-blue-600 rounded-full font-bold shadow-lg hover:bg-blue-50 hover:scale-105 transition-all"
          >
            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"
              ><path
                d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.008-.57-.008-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.548 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"
              ></path></svg
            >
            Soporte WhatsApp
          </a>
        </div>
      </div>
    </div>
  </section>

  <script type="application/ld+json" set:html={JSON.stringify(schema)} />

  <!-- SEARCH SCRIPT (Simple client-side filtering) -->
  <script>
    document.addEventListener("astro:page-load", () => {
      const input = document.getElementById("faq-search");

      if (input) {
        input.addEventListener("keyup", (e) => {
          const term = (e.target as HTMLInputElement).value.toLowerCase();
          const allDetails = document.querySelectorAll("details");
          let hasResults = false;

          allDetails.forEach((detail) => {
            const summary =
              detail.querySelector("summary")?.textContent?.toLowerCase() || "";
            const content = detail.textContent?.toLowerCase() || "";

            // Si coincide, mostrar. Si no, ocultar el padre directo si es un contenedor de item individual
            if (summary.includes(term) || content.includes(term)) {
              detail.parentElement!.style.display = "block";
              hasResults = true;
              // Opcional: Abrir si hay coincidencia
              if (term.length > 2) detail.open = true;
            } else {
              detail.parentElement!.style.display = "none";
            }
          });

          // Aqu√≠ podr√≠as manejar un estado de "No results found" visual
        });
      }
    });

    // Fallback inicial
    if (document.readyState === "complete")
      document.dispatchEvent(new Event("astro:page-load"));
    else
      document.addEventListener("DOMContentLoaded", () =>
        document.dispatchEvent(new Event("astro:page-load")),
      );
  </script>
</BaseLayout>
